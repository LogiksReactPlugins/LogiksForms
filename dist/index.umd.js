(function(W,T){typeof exports=="object"&&typeof module<"u"?T(exports,require("react"),require("axios"),require("yup"),require("formik")):typeof define=="function"&&define.amd?define(["exports","react","axios","yup","formik"],T):(W=typeof globalThis<"u"?globalThis:W||self,T(W.LogiksForm={},W.React,W.axios,W.Yup,W.formik))})(this,function(W,T,K,je,se){"use strict";function Ne(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const i in e)if(i!=="default"){const o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,o.get?o:{enumerable:!0,get:()=>e[i]})}}return r.default=e,Object.freeze(r)}const B=Ne(je);var ne={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xe;function we(){if(xe)return J;xe=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(o,l,m){var p=null;if(m!==void 0&&(p=""+m),l.key!==void 0&&(p=""+l.key),"key"in l){m={};for(var d in l)d!=="key"&&(m[d]=l[d])}else m=l;return l=m.ref,{$$typeof:e,type:o,key:p,ref:l!==void 0?l:null,props:m}}return J.Fragment=r,J.jsx=i,J.jsxs=i,J}var ee={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be;function Se(){return be||(be=1,process.env.NODE_ENV!=="production"&&function(){function e(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===P?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case I:return"Fragment";case v:return"Profiler";case y:return"StrictMode";case M:return"Suspense";case s:return"SuspenseList";case j:return"Activity"}if(typeof a=="object")switch(typeof a.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),a.$$typeof){case F:return"Portal";case w:return(a.displayName||"Context")+".Provider";case A:return(a._context.displayName||"Context")+".Consumer";case $:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case q:return c=a.displayName||null,c!==null?c:e(a.type)||"Memo";case z:c=a._payload,a=a._init;try{return e(a(c))}catch{}}return null}function r(a){return""+a}function i(a){try{r(a);var c=!1}catch{c=!0}if(c){c=console;var u=c.error,h=typeof Symbol=="function"&&Symbol.toStringTag&&a[Symbol.toStringTag]||a.constructor.name||"Object";return u.call(c,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",h),r(a)}}function o(a){if(a===I)return"<>";if(typeof a=="object"&&a!==null&&a.$$typeof===z)return"<...>";try{var c=e(a);return c?"<"+c+">":"<...>"}catch{return"<...>"}}function l(){var a=D.A;return a===null?null:a.getOwner()}function m(){return Error("react-stack-top-frame")}function p(a){if(H.call(a,"key")){var c=Object.getOwnPropertyDescriptor(a,"key").get;if(c&&c.isReactWarning)return!1}return a.key!==void 0}function d(a,c){function u(){de||(de=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",c))}u.isReactWarning=!0,Object.defineProperty(a,"key",{get:u,configurable:!0})}function g(){var a=e(this.type);return V[a]||(V[a]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),a=this.props.ref,a!==void 0?a:null}function S(a,c,u,h,N,x,_,G){return u=x.ref,a={$$typeof:C,type:a,key:c,props:x,_owner:N},(u!==void 0?u:null)!==null?Object.defineProperty(a,"ref",{enumerable:!1,get:g}):Object.defineProperty(a,"ref",{enumerable:!1,value:null}),a._store={},Object.defineProperty(a._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(a,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(a,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:_}),Object.defineProperty(a,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:G}),Object.freeze&&(Object.freeze(a.props),Object.freeze(a)),a}function b(a,c,u,h,N,x,_,G){var k=c.children;if(k!==void 0)if(h)if(L(k)){for(h=0;h<k.length;h++)O(k[h]);Object.freeze&&Object.freeze(k)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else O(k);if(H.call(c,"key")){k=e(a);var Q=Object.keys(c).filter(function(pe){return pe!=="key"});h=0<Q.length?"{key: someKey, "+Q.join(": ..., ")+": ...}":"{key: someKey}",n[k+h]||(Q=0<Q.length?"{"+Q.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,h,k,Q,k),n[k+h]=!0)}if(k=null,u!==void 0&&(i(u),k=""+u),p(c)&&(i(c.key),k=""+c.key),"key"in c){u={};for(var ae in c)ae!=="key"&&(u[ae]=c[ae])}else u=c;return k&&d(u,typeof a=="function"?a.displayName||a.name||"Unknown":a),S(a,k,x,N,l(),u,_,G)}function O(a){typeof a=="object"&&a!==null&&a.$$typeof===C&&a._store&&(a._store.validated=1)}var f=T,C=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),w=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),s=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),P=Symbol.for("react.client.reference"),D=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=Object.prototype.hasOwnProperty,L=Array.isArray,Y=console.createTask?console.createTask:function(){return null};f={"react-stack-bottom-frame":function(a){return a()}};var de,V={},E=f["react-stack-bottom-frame"].bind(f,m)(),R=Y(o(m)),n={};ee.Fragment=I,ee.jsx=function(a,c,u,h,N){var x=1e4>D.recentlyCreatedOwnerStacks++;return b(a,c,u,!1,h,N,x?Error("react-stack-top-frame"):E,x?Y(o(a)):R)},ee.jsxs=function(a,c,u,h,N){var x=1e4>D.recentlyCreatedOwnerStacks++;return b(a,c,u,!0,h,N,x?Error("react-stack-top-frame"):E,x?Y(o(a)):R)}}()),ee}var ge;function Ae(){return ge||(ge=1,process.env.NODE_ENV==="production"?ne.exports=we():ne.exports=Se()),ne.exports}var t=Ae();function Ee(e){return e.template==="accordion"?"accordion":e.template==="simple"?"simple":e.template==="cards"?"cards":Object.values(e.fields||{}).some(o=>o.group)?"tab":"simple"}function $e(e,r="create",i="Info"){const o={};let l=!1;if(Object.values(e).forEach(p=>{p.group&&(l=!0)}),!l)return{};const m=[];return Object.entries(e).forEach(([p,d])=>{if(d.vmode==="edit"&&r==="create")return;const g={...d,name:p};if(d.group){const S=d.group;o[S]||(o[S]=[]),o[S].push(g)}else m.push(g)}),m.length>0?{[i]:m,...o}:o}function ye(e,r="create"){const i={};return Object.keys(e).forEach(o=>{e[o].vmode==="edit"&&r==="create"||(i[o]={label:o,required:e[o].required??!1})}),i}const te=(e,r,i,o)=>{e.forEach(l=>{const m=l?.name;if(!m)return;let p=o?.[m];p==null&&(p=l.default),l.multiple===!0||l.type==="checkbox"||l.type==="tags"?r[m]=Array.isArray(p)?p:typeof p=="string"?p.split(",").map(g=>g.trim()).filter(Boolean):[]:l.type==="json"?r[m]=typeof p=="object"&&p!==null?JSON.stringify(p,null,2):p??"":l.type==="date"?r[m]=typeof p=="string"?p.slice(0,10):"":l.type==="time"?typeof p=="string"?p.includes("T")?r[m]=p.slice(11,16):r[m]=p.slice(0,5):r[m]="":m==="blocked"||m==="blacklist"?r[m]=String(p??"false"):r[m]=p??"";let d;l.type==="file"?d=l.multiple?B.array().of(B.mixed()):B.mixed():l.multiple===!0||l.type==="checkbox"||l.type==="tags"?d=B.array().of(B.string()):l.type==="email"?d=B.string().email("Invalid email"):l.type==="number"?d=B.number().typeError("Must be a number"):l.type==="json"?d=B.string().test("json","Invalid JSON",g=>{if(!g)return!0;try{return JSON.parse(g),!0}catch{return!1}}):d=B.string(),l.required&&(d=d.required(l.error_message||`${l.label||m} is required`)),l?.validate?.regex&&typeof l.validate.regex=="string"&&(d=d.matches(new RegExp(l?.validate?.regex),l?.error_message||"Invalid input format")),l?.validate&&Object.entries(l.validate).forEach(([g,S])=>{switch(g){case"email":S&&(d=d.email("Invalid email format"));break;case"mobile":d=d.matches(/^[1-9][0-9]*$/,"Invalid mobile number format");break;case"regex":d=d.matches(new RegExp(S),`Must match pattern: ${S}`);break;case"date":d=B.date().typeError("Invalid date format (expected dd/MM/yyyy or dd-MM-yyyy)").transform((b,O)=>{if(typeof O=="string"){const f=O.replace(/-/g,"/"),[C,F,I]=f.split("/");if(C&&F&&I)return new Date(`${I}-${F}-${C}`)}return b});break;case"time":d=d.matches(/^([0-1][0-9]|2[0-3])[:\-]([0-5][0-9])$/,"Invalid time format (HH:MM)");break;case"timesec":d=d.matches(/^([0-1][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/,"Invalid time format (HH:MM:SS)");break;case"number":case"numeric":d=B.number().typeError("Must be numeric");break;case"float":case"decimal":d=B.number().typeError("Must be a decimal").transform((b,O)=>{if(O==null||O==="")return;const f=Number(O);if(isNaN(f))return b;if(typeof b=="number"&&!isNaN(b)){const C=Number(b);return Number.isInteger(C)?Number(f.toFixed(C)):f}return f});break;case"alphanumeric":d=d.matches(/^[a-z0-9]+$/i,"Must be alphanumeric");break;case"alpha":d=d.matches(/^[a-zA-Z]+$/,"Must contain only letters");break;case"upper":d=d.transform(b=>b&&b.toUpperCase());break;case"lower":d=d.transform(b=>b&&b.toLowerCase());break;case"length-min":{const b=Number(S);isNaN(b)||(d=d.min(b,`Minimum length is ${b}`));break}case"length-max":{const b=Number(S);isNaN(b)||(d=d.max(b,`Maximum length is ${b}`));break}}}),i[m]=d})},oe={12:"lg:col-span-12",11:"lg:col-span-11",10:"lg:col-span-10",9:"lg:col-span-9",8:"lg:col-span-8",7:"lg:col-span-7",6:"lg:col-span-6",5:"lg:col-span-5",4:"lg:col-span-4",3:"lg:col-span-3",2:"lg:col-span-2",1:"lg:col-span-1"};function le(e){return[1,2,3,4,5,6,7,8,9,10,11,12].includes(e)?e:6}const ie=e=>e===!0||e==="true",U=(e,r)=>typeof e=="string"?e.replace(/#(\w+)#/g,(i,o)=>r[o]!==void 0?String(r[o]):i):Array.isArray(e)?e.map(i=>U(i,r)):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([i,o])=>[U(i,r),U(o,r)])):e,X=(e,r,i,o)=>{if(!Array.isArray(i)||i.length===0)return{};const l=o??(i[0]&&typeof i[0]=="object"&&"category"in i[0]?"category":void 0);if(!l){const p={};return i.forEach(d=>{const g=d[e],S=d[r];g!=null&&S!=null&&(p[String(g)]=String(S))}),p}const m={};return i.forEach(p=>{const d=p[l]??"Others",g=p[e],S=p[r];g==null||S==null||(m[d]||(m[d]={}),m[d][String(g)]=String(S))}),m},fe=(e,r)=>{if(!e||r==null)return;const i=String(r);if(typeof Object.values(e)[0]=="string")return e[i];for(const l of Object.values(e))if(i in l)return l[i]},Oe=e=>{if(!e)return[];if(Array.isArray(e))return e.map(o=>[String(o.value),String(o.title??o.label??o.value)]);const r=Object.values(e);return r.length?typeof r[0]=="string"?Object.entries(e).map(([o,l])=>[String(o),l]):Object.values(e).flatMap(o=>Object.entries(o).map(([l,m])=>[String(l),m])):[]},ve=e=>{if(!e||typeof e!="object")return!1;const r=Object.values(e)[0];return typeof r=="object"&&r!==null&&!Array.isArray(r)};async function Te(){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by this browser. You cannot access this portal.");try{const e=await new Promise((o,l)=>{navigator.geolocation.getCurrentPosition(o,l,{enableHighAccuracy:!1,timeout:3e4,maximumAge:12e4})}),{latitude:r,longitude:i}=e.coords;return`${r},${i}`}catch(e){if(!(e instanceof GeolocationPositionError))throw new Error("Failed to get your location.");switch(e.code){case e.PERMISSION_DENIED:throw new Error("Please allow location access in browser settings.");case e.POSITION_UNAVAILABLE:throw new Error("Unable to detect your location. Try connecting to Wi-Fi.");case e.TIMEOUT:throw new Error("Your device took too long to fetch GPS position.");default:throw new Error("Failed to get your location.")}}}const Ce=e=>Object.entries(e??{}).filter(([,r])=>r.type==="geolocation").map(([r])=>r);function Fe(e,r="create"){return Object.entries(e).filter(([,i])=>!(i.vmode==="edit"&&r==="create")).map(([i,o])=>({...o,name:i}))}async function ce(e,r,i,o=void 0,l=void 0,m={}){try{let p=i;return p||(p=(await K({method:"POST",url:e.baseURL+e.registerQuery,data:{query:r??{},srcid:l},headers:{Authorization:`Bearer ${e?.accessToken}`}})).data.queryid),await K({method:"POST",url:e.baseURL+e.runQuery,data:{queryid:p,filter:m,refid:o,page:0,limit:1e4},headers:{Authorization:`Bearer ${e?.accessToken}`}})}catch(p){throw p}}function Ie(e){return typeof e=="object"&&e!==null&&typeof e.target=="string"&&typeof e.src=="object"&&e.src!==null&&typeof e.src.table=="string"}function Pe(e){return e.split(",").map(r=>r.trim()).map(r=>{const i=r.match(/^(.+?)\s+as\s+.+$/i);return i?i[1]?.trim():r}).filter(r=>!!r)}const Z=e=>{const r={};for(const[i,o]of Object.entries(e)){const l=i.includes(".")?i.split(".").pop():i;if(l in r){console.warn(`Duplicate key after normalization: ${l}`);continue}r[l]=o}return r};function ue({field:e,formik:r,methods:i={},sqlOpsUrls:o,refid:l,module_refid:m,optionsOverride:p,setFieldOptions:d}){const[g,S]=T.useState(!1),[b,O]=T.useState(p??e.options??{}),[f,C]=T.useState(""),[F,I]=T.useState(0),y=T.useRef(null),v=T.useRef(null),[A,w]=T.useState(!1),$=T.useRef(f);T.useEffect(()=>{$.current=f},[f]);const M=E=>{E.currentTarget.open||C("")};T.useEffect(()=>{p&&Object.keys(p).length!==0&&O(p)},[p]),T.useEffect(()=>{const E=R=>{v.current&&!v.current.contains(R.target)&&(v.current.open=!1,C(""))};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const s=e.name;T.useEffect(()=>{let E=!0;return(async()=>{let n=e.valueKey??"value",a=e.labelKey??"title";if(e?.options){if(typeof e.options=="object"&&!Array.isArray(e.options)){const x=Object.values(e.options);if(x.length&&typeof x[0]=="string"){O(e.options);return}}const h=(Array.isArray(e.options)?e.options:[e.options]).map(Z),N=X(n,a,h,e.groupKey);O(N);return}const c=e?.source??{};if(e.type==="dataMethod"){const u=e.method,h=u?i[u]:void 0;if(h)try{const N=await Promise.resolve(h()),x=Array.isArray(N?.data?.data)?N.data.data:Array.isArray(N?.data)?N.data:N,_=Array.isArray(x)?x.map(Z):[],G=X(n,a,_,e.groupKey);E&&O(G)}catch(N){console.error("Method execution failed:",N),E&&O({})}else E&&O({})}if(c.type==="api"&&c.url)try{const u=await K({method:c.method||"GET",url:c.url,data:c.body??{},params:c.params??{},headers:c.headers??{}}),h=Array.isArray(u?.data?.data)?u.data.data:Array.isArray(u?.data)?u.data:u,N=Array.isArray(h)?h.map(Z):[],x=X(n,a,N,e.groupKey);E&&O(x)}catch(u){console.error("API execution failed:",u),E&&O({})}if(e.table||e.type==="dataSelector"||e.queryid){if(!o){console.error("SQL source requires formJson.endPoints but it is missing");return}try{let u;if(e.type==="dataSelector")u={table:"do_lists",cols:"title,value",where:{groupid:e.groupid??""}};else if(!e.queryid){if(!e.table||!e.columns){console.error("Invalid SQL field config",e);return}u={table:e.table,cols:e.columns,where:e.where?l?U(e.where,{refid:l}):e.where:void 0}}const h=await ce(o,u,e?.queryid,void 0,m),N=Array.isArray(h?.data?.data)?h.data.data:Array.isArray(h?.data)?h.data:h,x=Array.isArray(N)?N.map(Z):[],_=X(n,a,x,e.groupKey);E&&O(_)}catch(u){console.error("API fetch failed:",u)}}})(),()=>{E=!1}},[e.options,e.source,e.table,e.columns,e.where,l]);const q=`
    w-full px-4 py-2 rounded-lg border border-gray-200 transition-all duration-300 
    bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
    focus:outline-none focus:ring-0
  `,z=`
    border-gradient-to-r 
    focus:border-gray-400 focus:shadow-lg focus:shadow-gray-100/50
  `,j=`
    block text-sm font-semibold mb-1  transition-all duration-300 text-gray-700
  `,P=E=>E.icon?t.jsx("i",{className:E.icon}):null,D=T.useMemo(()=>Oe(b),[b]);console.log("flatOptions",D);const H=D.length,L=T.useMemo(()=>e.search||!f?D:D.filter(([,E])=>E.toLowerCase().includes(f.toLowerCase())),[e.search,f,D]),Y=(E,R)=>{if(v.current?.open===!0||A===!0)if(E.key==="ArrowDown")E.preventDefault(),I(n=>n+1<L.length?n+1:0);else if(E.key==="ArrowUp")E.preventDefault(),I(n=>n-1>=0?n-1:L.length-1);else if(E.key==="Enter"){E.preventDefault();const[n]=L[F]||[];n&&r.setFieldValue(e.name,R?n:[...r.values[e.name],n]),v.current&&(v.current.open=!1)}else E.key==="Escape"&&(v.current.open=!1,C(""),w(!1))};T.useEffect(()=>{y.current?.querySelector(`[data-index="${F}"]`)?.scrollIntoView({block:"nearest"})},[F]),T.useEffect(()=>{F>=L.length&&I(0)},[L,F]),T.useEffect(()=>{const E=e.autocomplete,R=e.ajaxchain;if(!E&&!R)return;const n=r.values[e.name];if(!n)return;const a=Array.isArray(R)?R:R?[R]:[];(async()=>{try{if(Ie(E)){const u=E.src;if(!u||!o)return;const h=U(u.where??{},{refid:n}),N={...u,table:u.table,cols:u.columns,where:h},{data:x}=await ce(o,N,e?.queryid,void 0,m),_=Array.isArray(x?.data)?x.data[0]:x?.data;_&&E.target.split(",").map(G=>G.trim()).forEach(G=>{_[G]!==void 0&&r.setFieldValue(G,_[G])})}for(const u of a){const h=u.src;if(!u||typeof u!="object"||!h||typeof h!="object"||!o)continue;let N;if(!h.queryid){if(!h.table||!h.columns)throw new Error("SQL query requires field.table");const pe=U(h?.where??{},{refid:n});N={...h,table:h.table,cols:h.columns,where:pe}}const{data:x}=await ce(o,N,h?.queryid,n,m);let _=e.valueKey??"value",G=e.labelKey??"title";const k=Array.isArray(x?.data?.data)?x.data.data:Array.isArray(x?.data)?x.data:x,Q=Array.isArray(k)?k.map(Z):[],ae=X(_,G,Q,e.groupKey);d?.(u.target,ae)}}catch(u){console.error("Autocomplete / AjaxChain fetch failed",u)}})()},[r.values[e.name]]),T.useEffect(()=>{if(!e.search||!f.trim()||!e.table||!o)return;const E=Pe(e.columns??""),R=new AbortController,n=setTimeout(async()=>{try{let a;if(!e.queryid){if(!e.table||!e.cols)throw new Error("SQL query requires field.table");const k=l?U(e.where??{},{refid:l}):e.where;a={...e,table:e.table,cols:e.columns||e.cols,where:k}}let c={};Array.isArray(E)&&E.forEach(k=>{c[k]=[f,"LIKE"]});let u=e.valueKey??"value",h=e.labelKey??"title";const{data:N}=await ce(o,a,e?.queryid,void 0,m,c),x=Array.isArray(N?.data?.data)?N.data.data:Array.isArray(N?.data)?N.data:N,_=Array.isArray(x)?x.map(Z):[],G=X(u,h,_,e.groupKey);O(G)}catch(a){if(K.isCancel(a))return;console.error("Search fetch failed",a)}},500);return()=>{clearTimeout(n),R.abort()}},[f,l]);const de=async E=>{if(E.length===0){console.error("No file");return}const R=o?.baseURL+o?.uploadURL;if(!R){console.error("No Upload URL ");return}const n=e.multiple===!0;try{const a=await Promise.all(Array.from(E).map(async c=>{const u=new FormData;return u.append("file",c),(await K({method:"POST",url:R,data:u,headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o?.accessToken}`}})).data}));r.setFieldValue(s,n?a.map(c=>c.path):a[0]?.path)}catch(a){console.error("File upload failed",a),r.setFieldError(s,"File upload failed")}};console.log("options",b);const V=async(E,R,n)=>{const a=R[E];if(!a)return;const c=i?.[a];if(typeof c!="function"){console.error(`Method "${String(a)}" not found`);return}try{await Promise.resolve(c(n))}catch(u){console.error(`Method "${String(a)}" failed`,u)}};switch(e.type){case"autocomplete":{const n=r.values[s]??"",a=f!==""?f:fe(b,n)??String(n??""),c=h=>{const N=h.target.value;C(N),I(0),N.trim()?w(!0):(w(!1),r.setFieldValue(s,""))},u=h=>{r.setFieldValue(s,h),C(""),w(!1),V("onChange",e,`${s}-${h}`)};return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{className:`${q} ${z}`,value:a,placeholder:e.placeholder||"Type to search...",onChange:c,onBlur:()=>{setTimeout(()=>w(!1),150)},onKeyDown:h=>{if(h.key==="Enter"){if(h.preventDefault(),L[F]){const[N]=L[F];r.setFieldValue(s,N)}else f.trim()&&r.setFieldValue(s,f.trim());w(!1);return}Y(h,!0)},disabled:e.disabled}),A&&t.jsx("div",{ref:y,className:"absolute z-20 w-full bg-white border rounded shadow max-h-52 overflow-y-auto mt-1",children:L.length>0?L.map(([h,N],x)=>t.jsx("div",{id:`${s}-${h}`,"data-index":x,className:`px-3 py-2 cursor-pointer text-sm
                  ${F===x?"bg-gray-100":"hover:bg-gray-100"}`,onMouseDown:()=>u(h),children:N},h)):t.jsx("div",{className:"px-3 py-2 text-sm text-gray-400",children:`No matches press enter to add "${a}" `})}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}case"dataSelector":case"dataSelectorFromTable":case"dataSelectorFromUniques":case"dataMethod":{if(e.multiple===!0){const n=r.values[s];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("details",{className:"relative w-full",onToggle:M,ref:v,onKeyDown:a=>Y(a,!1),children:[t.jsxs("summary",{className:"cursor-pointer select-none border border-gray-300 rounded-lg px-3 py-2 bg-white flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-700",children:n?.length>0?n.join(", "):`Select ${e.label}`}),t.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs("div",{ref:y,className:"absolute mt-1 w-full border border-gray-200 rounded-lg bg-white shadow-md z-10 max-h-60 overflow-y-auto p-2",children:[e.search&&t.jsx("div",{className:"sticky top-0 bg-white p-1",children:t.jsx("input",{type:"text",value:f,onChange:a=>{C(a.target.value),I(0)},placeholder:"Search...",className:`px-2 py-[5px] rounded w-full border border-gray-200 transition-all duration-300 
                bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
                focus:outline-none focus:ring-0`})}),L.length>0?L.map(([a,c],u)=>t.jsxs("label",{htmlFor:`${s}-${a}`,className:`flex items-center gap-x-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm
                        ${n?.includes(a)?"bg-indigo-50 text-indigo-600 font-medium":F===u?"bg-gray-100":"hover:bg-gray-50"}`,children:[t.jsx("input",{id:`${s}-${a}`,type:"checkbox",checked:n?.includes(a),onChange:h=>{const N=h.target.checked?[...n,a]:n?.filter(x=>x!==a);r.setFieldValue(s,N),V("onChange",e,`${s}-${a}`)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),c]},a)):t.jsx("div",{className:"px-2 py-1 text-gray-400 text-sm",children:"No results"})]})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("details",{className:"relative w-full",onToggle:M,ref:v,onKeyDown:n=>Y(n,!0),children:[t.jsxs("summary",{className:"cursor-pointer select-none border border-gray-300 rounded-lg px-3 py-2 bg-white flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-700",children:r.values[s]?fe(b,r.values[s])??"Select option":`Select ${e.label}`}),t.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs("div",{ref:y,className:"absolute mt-1 w-full border border-gray-200 rounded-lg bg-white shadow-md z-10 max-h-60 overflow-y-auto p-2",children:[e.search&&t.jsx("div",{className:"sticky top-0 bg-white p-1",children:t.jsx("input",{type:"text",value:f,onChange:n=>{C(n.target.value),I(0)},onKeyDown:n=>Y(n,!0),placeholder:"Search...",className:`px-2 py-[5px] rounded w-full border border-gray-200 transition-all duration-300 
                  bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
                  focus:outline-none focus:ring-0`})}),L.length>0&&t.jsx("div",{onClick:n=>{n.preventDefault(),n.stopPropagation(),r.setFieldValue(s,""),v.current?.removeAttribute("open"),C("")},className:"px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm hover:bg-gray-50",children:"Clear selection"}),L.length>0?L.map(([n,a],c)=>t.jsx("div",{id:`${s}-${n}`,"data-index":c,onClick:u=>{u.preventDefault(),u.stopPropagation(),r.setFieldValue(s,n),v.current?.removeAttribute("open"),C(""),I(0),V("onChange",e,`${s}-${n}`)},className:`px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm 
                        ${r.values[s]===n?"bg-indigo-50 text-indigo-600 font-medium":F===c?"bg-gray-100":"hover:bg-gray-50"}`,children:a},n)):t.jsx("div",{className:"px-2 py-1 text-gray-400 text-sm",children:"No results"})]})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}case"textarea":return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("textarea",{id:s,className:`${q} ${z} min-h-[120px] resize-none`,onFocus:()=>S(!0),name:s,value:r.values[s],onBlur:r.handleBlur,onChange:n=>{r.setFieldValue(s,n.target.value),V("onChange",e,`${s}`)},placeholder:e.placeholder,disabled:e.disabled}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})});case"select":if(e.multiple===!0){const n=r.values[s];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("details",{className:"relative w-full",onToggle:M,ref:v,onKeyDown:a=>Y(a,!1),children:[t.jsxs("summary",{className:"cursor-pointer select-none border border-gray-300 rounded-lg px-3 py-2 bg-white flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-700",children:n?.length>0?n.join(", "):`Select ${e.label}`}),t.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs("div",{ref:y,className:"absolute mt-1 w-full border border-gray-200 rounded-lg bg-white shadow-md z-10 max-h-60 overflow-y-auto p-2",children:[e.search&&t.jsx("div",{className:"sticky top-0 bg-white p-1",children:t.jsx("input",{type:"text",value:f,onChange:a=>{C(a.target.value),I(0)},placeholder:"Search...",className:`px-2 py-[5px] rounded w-full border border-gray-200 transition-all duration-300 
                bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
                focus:outline-none focus:ring-0`})}),L.length>0?L.map(([a,c],u)=>t.jsxs("label",{htmlFor:`${s}-${a}`,className:`flex items-center gap-x-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm
                        ${n?.includes(a)?"bg-indigo-50 text-indigo-600 font-medium":F===u?"bg-gray-100":"hover:bg-gray-50"}`,children:[t.jsx("input",{id:`${s}-${a}`,type:"checkbox",checked:n?.includes(a),onChange:h=>{const N=h.target.checked?[...n,a]:n?.filter(x=>x!==a);r.setFieldValue(s,N),V("onChange",e,`${s}-${a}`)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),c]},a)):t.jsx("div",{className:"px-2 py-1 text-gray-400 text-sm",children:"No results"})]})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("select",{className:`${q} ${z} appearance-none cursor-pointer pr-12`,onFocus:()=>S(!0),name:s,id:s,value:r.values[s],onBlur:r.handleBlur,onChange:n=>{r.setFieldValue(s,n.target.value===""?"":n.target.value),V("onChange",e,`${s}`)},disabled:e.disabled,children:[t.jsx("option",{value:"",disabled:!0,children:e?.["no-option"]||`Please select ${e.label}`}),!ve(b)&&Object.entries(b).map(([n,a])=>t.jsx("option",{value:n,className:"py-2",children:a},n)),ve(b)&&Object.entries(b).map(([n,a])=>t.jsx("optgroup",{label:n,children:Object.entries(a).map(([c,u])=>t.jsx("option",{value:c,children:u},c))},n))]}),t.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:t.jsx("svg",{className:"w-5 h-5 transition-colors duration-300 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"radioList":case"radio":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{className:`flex ${H>3?"flex-col":""} gap-2 ml-1`,children:Object.entries(b||{}).map(([n,a])=>t.jsxs("label",{htmlFor:`${s}-${n}`,className:"flex items-center gap-x-2 text-sm font-medium text-gray-700 cursor-pointer",children:[t.jsx("input",{id:`${s}-${n}`,type:"radio",name:s,checked:r.values[s]===n,value:n,onChange:c=>{r.setFieldValue(s,c.target.value===""?"":c.target.value),V("onChange",e,`${s}-${n}`)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),a]},n))}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]});case"checkbox":{const n=r.values[s];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{className:"flex flex-col gap-2 ml-1",children:Object.entries(b||{}).map(([a,c])=>t.jsxs("label",{className:"flex items-center gap-x-2 text-sm font-medium text-gray-700 cursor-pointer",children:[t.jsx("input",{id:`${s}-${a}`,type:"checkbox",checked:n.includes(a),onChange:u=>{const h=u.target.checked?[...n,a]:n.filter(N=>N!==a);r.setFieldValue(s,h),V("onChange",e,`${s}-${a}`)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),c]},a))}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}case"tags":{const n=r.values[s],a=f.trim(),c=Array.isArray(b)?b:Object.entries(b||{}).map(([x,_])=>({value:x,label:_})),u=x=>{x&&!n.includes(x)&&(r.setFieldValue(s,[...n,x]),C(""))},h=x=>{r.setFieldValue(s,n.filter(_=>_!==x))},N=x=>c.find(_=>_.value===x)?.label??x;return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:`${q} flex flex-wrap gap-2 min-h-[42px] max-h-[120px] overflow-y-auto items-center`,onClick:()=>!e.disabled&&document.getElementById(`${s}-input`)?.focus(),children:[n.map(x=>t.jsxs("span",{className:"flex items-center gap-2 px-2 py-1 rounded-full text-sm bg-indigo-50 border border-indigo-100",children:[t.jsx("span",{className:"text-indigo-700",children:N(x)}),t.jsx("button",{type:"button",onClick:_=>{_.stopPropagation(),e.disabled||h(x)},onMouseDown:_=>_.preventDefault(),className:"ml-1 text-indigo-500 hover:text-red-500 focus:outline-none",children:"Ã—"})]},x)),t.jsx("input",{id:`${s}-input`,type:"text",value:f,onChange:x=>C(x.target.value),onKeyDown:x=>{(x.key==="Enter"||x.key===",")&&(x.preventDefault(),u(a))},placeholder:n.length===0?e.placeholder||"Type and press Enter":"",className:"flex-1 min-w-[120px] border-none outline-none text-sm bg-transparent p-1",disabled:e.disabled})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}case"attachment":case"photo":case"avatar":case"file":const E=e.multiple===!0,R=Array.isArray(r.values[s])?r.values[s]:r.values[s]?[r.values[s]]:[];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:P(e)}),t.jsx("input",{id:s,type:"file",className:`${q} ${z} ${e.icon?"pl-9":""} `,onFocus:()=>S(!0),name:s,multiple:E,onChange:n=>{const a=n.currentTarget.files;a&&de(a),V("onChange",e,`${s}`)},onBlur:r.handleBlur,placeholder:e.placeholder,disabled:e.disabled}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),R.map(n=>{const a=n?.split("/").pop();return a?t.jsx("div",{className:"mt-1",children:t.jsx("span",{className:"text-sm",children:a})},n):null}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"json":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("textarea",{id:s,name:s,value:r.values[s],onChange:n=>{r.setFieldValue(s,n.target.value),V("onChange",e,`${s}`)},onBlur:r.handleBlur,placeholder:e.placeholder||"Enter valid JSON",disabled:e.disabled,className:`${q} ${z} min-h-[200px] font-mono text-sm resize-y`}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-emerald-400 to-cyan-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"date":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:P(e)}),t.jsx("input",{id:s,type:"date",name:s,min:e.min,max:e.max,value:r.values[s],onChange:n=>{r.setFieldValue(s,n.target.value),V("onChange",e,`${s}`)},onBlur:r.handleBlur,placeholder:e.placeholder,disabled:e.disabled,className:`${q} ${z} ${e.icon?"pl-9":""}`}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"number":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:P(e)}),t.jsx("input",{id:s,type:e.type||"text",className:`${q} ${z} ${e.icon?"pl-9":""} `,onFocus:()=>S(!0),name:s,value:r.values[s],onBlur:r.handleBlur,onChange:n=>{r.setFieldValue(s,n.target.value),V("onChange",e,`${s}`)},placeholder:e.placeholder,disabled:e.disabled,min:e.min,max:e.max}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});default:return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:j,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:P(e)}),t.jsx("input",{id:s,type:e.type||"text",className:`${q} ${z} ${e.icon?"pl-9":""} `,onFocus:()=>S(!0),name:s,value:r.values[s],onBlur:r.handleBlur,onChange:n=>{r.setFieldValue(s,n.target.value),V("onChange",e,`${s}`)},placeholder:e.placeholder,disabled:e.disabled,minLength:e.minlength,maxLength:e.maxlength}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${g?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}}function _e({title:e,children:r,isFirst:i}){const[o,l]=T.useState(i);return t.jsx("div",{className:"group relative mt-1",children:t.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-100 shadow-xs hover:shadow-sm transition-all duration-300 overflow-hidden ",children:[t.jsxs("button",{onClick:()=>l(!o),className:"w-full bg-gray-50 flex justify-between items-center px-6 py-3 b text-left transition-all duration-300 ",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full transition-all duration-300 ${o?"bg-action":"bg-gray-300"}`}),t.jsx("h3",{className:"text-md font-semibold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:e})]}),t.jsxs("div",{className:`relative transition-all duration-300 ${o?"rotate-180":""}`,children:[t.jsx("div",{className:`absolute inset-0 rounded-full blur-md transition-opacity duration-300 ${o?"bg-action opacity-30":"bg-transparent opacity-0"}`}),t.jsx("svg",{className:"relative w-4 h-4 text-gray-500 group-hover:text-action-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),t.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden  ${o?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:t.jsx("div",{className:"px-6 pb-6 bg-gradient-to-br from-gray-50/50 to-white overflow-auto mb-5",children:t.jsx("div",{className:"space-y-5 pt-4",children:r})})})]})})}function Re({title:e,groupedFields:r,data:i,onSubmit:o=b=>{},onCancel:l=()=>{},methods:m={},components:p={},sqlOpsUrls:d={},refid:g,module_refid:S}){const[b,O]=T.useState({}),f=(y,v)=>{O(A=>({...A,[y]:v}))},{initialValues:C,validationSchema:F}=T.useMemo(()=>{const y={},v={};return Object.values(r).flat().forEach(A=>{te([A],y,v,i)}),{initialValues:y,validationSchema:v}},[r,i]),I=se.useFormik({initialValues:C,enableReinitialize:!0,validationSchema:B.object().shape(F),onSubmit:y=>{o(y)}});return t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white border border-gray-100 rounded-md animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:I.handleSubmit,className:"p-4 mx-auto",children:[t.jsx("div",{className:"space-y-2",children:r&&Object.entries(r).map(([y,v],A)=>t.jsx(_e,{title:y,isFirst:A===0,children:t.jsx("div",{className:"grid grid-cols-12 gap-4",children:v.map((w,$)=>ie(w.hidden)||w.type==="geolocation"||w.vmode==="edit"&&d.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${oe[le(Number(w.width))]||"lg:col-span-4"}`,children:t.jsx(ue,{refid:g,module_refid:S,sqlOpsUrls:d,components:p,field:w,formik:I,methods:m,setFieldOptions:f,...b[w.name]?{optionsOverride:b[w.name]}:{}},w.name)},w?.name??`field-${$}`))})},y))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"text-sm text-gray-700",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Save"})]})]})]})})})}function ke({title:e,groupedFields:r,data:i,onSubmit:o=O=>{},onCancel:l=()=>{},methods:m={},components:p={},sqlOpsUrls:d={},widget:g,refid:S,module_refid:b}){const O=Object.keys(r),[f,C]=T.useState(0),[F,I]=T.useState({}),y=(j,P)=>{I(D=>({...D,[j]:P}))},{initialValues:v,validationSchema:A,stepperSchemas:w}=T.useMemo(()=>{const j={},P={},D={};return g?Object.entries(r).forEach(([H,L])=>{const Y={};te(L,j,Y,i),D[H]=Y}):Object.entries(r).forEach(([H,L])=>{te(L,j,P,i)}),{initialValues:j,validationSchema:P,stepperSchemas:D}},[r,i,g]),$=O[f]??null,M=g&&$?w[$]??{}:A,s=se.useFormik({initialValues:v,enableReinitialize:!0,validationSchema:B.object().shape(M),onSubmit:j=>{g?(f<O.length-1&&C(P=>P+1),f===O.length-1&&o(j)):o(j)}}),q=async j=>{if(j.preventDefault(),!g){const P=await s.validateForm();if(Object.keys(P).length>0){alert("Please fill all required fields before submitting."),s.setTouched(Object.keys(P).reduce((D,H)=>({...D,[H]:!0}),{}));return}}s.handleSubmit(j)},z=()=>{C(j=>j>0?j-1:j)};return t.jsxs("div",{className:" max-w-full  m-4",children:[t.jsx("div",{className:"relative",children:t.jsx("div",{className:"relative bg-gray-100 rounded-t-lg px-1 pt-1  shadow-inner",children:t.jsx("nav",{className:"relative flex",children:O.map((j,P)=>t.jsx("button",{type:"button",onClick:()=>C(P),className:`relative cursor-pointer flex-shrink-0 py-2 px-2 sm:px-4 rounded-t-lg  text-xs sm:text-sm font-semibold transition-all duration-300 ease-out focus:outline-none whitespace-nowrap ${f===P?"text-action bg-white":"text-gray-600 hover:text-gray-800 hover:bg-white/50"}`,children:t.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2 capitalize",children:j})},j))})})}),t.jsxs("div",{className:"bg-white  border border-gray-100 border-t-0 rounded-b-lg p-3 animate-in fade-in duration-300",children:[t.jsxs("form",{onSubmit:q,className:"w-full mx-auto",children:[t.jsx("div",{className:"grid grid-cols-12 gap-4",children:$&&r[$]?.map((j,P)=>ie(j.hidden)||j.type==="geolocation"||j.vmode==="edit"&&d.operation==="create"?null:t.jsx("div",{className:`col-span-12  ${oe[le(Number(j.width))]||"lg:col-span-4"}`,children:t.jsx(ue,{refid:S,module_refid:b,sqlOpsUrls:d,field:j,formik:s,methods:m,components:p,setFieldOptions:y,...F[j.name]?{optionsOverride:F[j.name]}:{}},j.name)},j?.name??`field-${P}`))}),t.jsxs("div",{className:`mt-8 flex ${f>0?"justify-between":"justify-end"} space-x-3`,children:[f>0&&t.jsx("button",{onClick:z,type:"button",className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Previous"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{onClick:l,type:"button",className:"px-5 cursor-pointer py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 cursor-pointer py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:g?"Next":"Save"})]})]})]}),t.jsx("div",{className:"mt-2 pt-3  border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{children:["Tab ",f+1," of ",O.length]}),t.jsx("p",{className:"text-sm text-gray-700 ml-3",children:"All fields marked (*) are required"})]}),t.jsx("div",{className:"flex gap-1",children:O.map((j,P)=>t.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${P===f?"bg-action w-6":"bg-gray-300"}`},P))})]})})]},O[f])]})}function Me({title:e,fields:r,data:i,onSubmit:o=S=>{},onCancel:l=()=>{},methods:m={},sqlOpsUrls:p={},refid:d,module_refid:g}){const S=Fe(r,p.operation),[b,O]=T.useState({}),f=(y,v)=>{O(A=>({...A,[y]:v}))},{initialValues:C,validationSchema:F}=T.useMemo(()=>{const y={},v={};return S.forEach(A=>{te([A],y,v,i)}),{initialValues:y,validationSchema:v}},[S,i]),I=se.useFormik({initialValues:C,enableReinitialize:!0,validationSchema:B.object().shape(F),onSubmit:y=>{o(y)}});return console.log("formik.values",I.values),t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white border border-gray-100 rounded-md animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:I.handleSubmit,className:"p-4  mx-auto",children:[t.jsx("div",{className:"grid grid-cols-12 gap-4",children:S.map((y,v)=>ie(y.hidden)||y.type==="geolocation"||y.vmode==="edit"&&p.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${oe[le(Number(y.width))]||"lg:col-span-4"}`,children:t.jsx(ue,{refid:d,module_refid:g,sqlOpsUrls:p,field:y,formik:I,methods:m,setFieldOptions:f,...b[y.name]?{optionsOverride:b[y.name]}:{}})},y?.name??`field-${v}`))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"text-sm text-gray-700",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 cursor-pointer",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 cursor-pointer",children:"Save"})]})]})]})})})}function Le({title:e,children:r}){return t.jsx("div",{className:"group relative mt-1",children:t.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden ",children:[t.jsx("button",{className:"w-full bg-gray-50 flex justify-between items-center px-6 py-3 b text-left transition-all duration-300 ",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 rounded-full transition-all duration-300 bg-action"}),t.jsx("h3",{className:"text-md font-semibold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:e})]})}),t.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden max-h-[2000px] opacity-100'
            }`,children:t.jsx("div",{className:"px-6 pb-6 bg-gradient-to-br from-gray-50/50 to-white",children:t.jsx("div",{className:"space-y-5 pt-4",children:r})})})]})})}function ze({title:e,groupedFields:r,data:i,onSubmit:o=b=>{},onCancel:l=()=>{},methods:m={},components:p={},sqlOpsUrls:d={},refid:g,module_refid:S}){const[b,O]=T.useState({}),f=(y,v)=>{O(A=>({...A,[y]:v}))},{initialValues:C,validationSchema:F}=T.useMemo(()=>{const y={},v={};return Object.values(r).flat().forEach(A=>{te([A],y,v,i)}),{initialValues:y,validationSchema:v}},[r,i]),I=se.useFormik({initialValues:C,enableReinitialize:!0,validationSchema:B.object().shape(F),onSubmit:y=>{o(y)}});return t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:I.handleSubmit,className:"p-4 mx-auto",children:[t.jsx("div",{className:"space-y-2",children:r&&Object.entries(r).map(([y,v],A)=>t.jsx(Le,{title:y,children:t.jsx("div",{className:"grid grid-cols-12 gap-4",children:v.map((w,$)=>ie(w.hidden)||w.type==="geolocation"||w.vmode==="edit"&&d.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${oe[le(Number(w.width))]||"lg:col-span-4"}`,children:t.jsx(ue,{refid:g,module_refid:S,sqlOpsUrls:d,components:p,field:w,formik:I,methods:m,setFieldOptions:f,...b[w.name]?{optionsOverride:b[w.name]}:{}},w.name)},w?.name??`field-${$}`))})},y))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"px-4 pt-4 text-sm text-secondary",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Save"})]})]})]})})})}const re=e=>({Authorization:`Bearer ${e.accessToken}`}),he=async e=>(await K.get(e.baseURL+e.dbopsGetHash,{headers:re(e)})).data.refhash,me=async(e,r)=>(await K.post(e.baseURL+e.dbopsGetRefId,r,{headers:re(e)})).data.refid,qe={async fetch(e,r,i,o){const l=await he(e);let m=!1,p;i&&(m=!0,p=i),console.log("skipquery,dbopsid",m,i),m||(p=await me(e,{operation:"fetch",source:r.source,fields:r.fields??{},datahash:l,srcid:o}));const d=await K.post(e.baseURL+e.dbopsFetch,{refid:p,datahash:l},{headers:re(e)});return d.data?.data??d.data},async create(e,r,i){const o=await he(e),l=await me(e,{operation:"create",source:r.source,fields:r.values,datahash:o,srcid:i});return(await K.post(e.baseURL+e.dbopsCreate,{refid:l,fields:r.values,datahash:o},{headers:re(e)})).data},async update(e,r,i){const o=await he(e),l=await me(e,{operation:"update",source:r.source,fields:r.values,datahash:o,srcid:i});return(await K.post(e.baseURL+e.dbopsUpdate,{refid:l,fields:r.values,datahash:o},{headers:re(e)})).data}};function De({formJson:e={title:"",fields:{},source:{}},methods:r={},userid:i=null,onCancel:o=()=>{},components:l={},callback:m=()=>{},initialvalues:p={}}){let d=Ee(e);const g=e.endPoints,S=e?.source?.refid,b=$e(e?.fields??{},g?.operation),[O,f]=T.useState(p),C=T.useMemo(()=>Ce(e.fields),[e.fields]);T.useEffect(()=>{let y=!0;return(async()=>{const A=e?.source??{};if(!A?.type){y&&f({});return}if(A.type==="method"){const w=A.method,$=w?r[w]:void 0;if($)try{const M=await Promise.resolve($());y&&f(M??{})}catch(M){console.error("Method execution failed:",M),y&&f({})}else y&&f({})}if(A.type==="api"&&g?.operation!=="create")try{const w=await K({method:A.method||"GET",url:A.url??"",data:A.body??{},params:A.params??{},headers:A.headers??{}});y&&f(w.data??{})}catch(w){console.error("API fetch failed:",w),y&&f({})}if(A.type==="sql"&&A.refid&&A.refid!=="0"&&g?.operation!=="create"||g?.operation!=="create"&&A.dbopsid){if(!g){console.error("SQL source requires formJson.endPoints but it is missing");return}try{const w=await qe.fetch(g,{source:{...A,table:A.table,columns:A.columns,where:U(A.where,{refid:S})},fields:ye(e.fields,g.operation)},A?.dbopsid,e?.module_refid);y&&f(w)}catch(w){console.error("API fetch failed:",w)}}})(),()=>{y=!1}},[i,e?.source?.type||"",e?.source?.method||"",e?.source?.url||"",JSON.stringify(e?.source?.params??{}),JSON.stringify(e?.source?.body??{}),JSON.stringify(e?.source?.headers??{})]);const F=async y=>{const v=e?.source??{};let A=null;if(C.length>0)try{A=await Te()}catch($){console.log("catch fetchGeolocation",$),A=null}const w={...y,...Object.fromEntries(C.map($=>[$,A]))};if(v.type==="method"){const $=v.method,M=$?r[$]:void 0;if(M)try{const s=await Promise.resolve(M(w));if(m?.(s),r?.handleActions){let q=g?.operation==="update"?S:s?.data?.refid;const z=e?.gotolink?.replace("{hashid}",String(q));r.handleActions(z)}}catch(s){m?.(s),console.error("Method execution failed:",s)}}if(v.type==="api"){if(!g){console.error("SQL source requires formJson.endPoints but it is missing");return}try{const $=await K({method:v.method||"POST",url:g.baseURL+v.endpoint,data:w??{},headers:{Authorization:`Bearer ${g?.accessToken}`}});if(m?.($),r?.handleActions){let M=g.operation==="update"?S:$?.data?.refid;const s=e?.gotolink?.replace("{hashid}",String(M));r.handleActions(s)}}catch($){m?.($),console.error("API fetch failed:",$)}}if(v.type==="sql"){const $=e.endPoints;if(!$){console.error("SQL source requires formJson.endPoints but it is missing");return}try{let M=!1,s;v?.dbopsid&&(M=!0,s=v?.dbopsid);const q=await K({method:"GET",url:$.baseURL+$.dbopsGetHash,headers:{Authorization:`Bearer ${$?.accessToken}`}});if(!M){let j={...v};v.where&&(j={...v,where:U(v.where,{refid:S})}),s=(await K({method:"POST",url:$.baseURL+$.dbopsGetRefId,data:{operation:$.operation,source:j,fields:ye(e.fields,$.operation),forcefill:e.forcefill,datahash:q.data.refhash,srcid:e?.module_refid},headers:{Authorization:`Bearer ${$?.accessToken}`}}))?.data.refid}const z=await K({method:"POST",url:$.baseURL+$[$.operation==="update"?"dbopsUpdate":"dbopsCreate"],data:{refid:s,fields:w,datahash:q.data.refhash},headers:{Authorization:`Bearer ${$?.accessToken}`}});if(console.log("res",z),m?.(z),r?.handleActions){let j=$.operation==="update"?S:z?.data?.refid;const P=e?.gotolink?.replace("{hashid}",String(j));r.handleActions(P)}}catch(M){m?.(M),console.error("API fetch failed:",M)}}},I={accordion:t.jsx(Re,{title:e?.title??"",groupedFields:b,data:O,onSubmit:F,onCancel:o,methods:r,components:l,sqlOpsUrls:g,refid:S,module_refid:e?.module_refid}),cards:t.jsx(ze,{title:e?.title??"",groupedFields:b,data:O,onSubmit:F,onCancel:o,methods:r,components:l,sqlOpsUrls:g,refid:S,module_refid:e?.module_refid}),tab:t.jsx(ke,{title:e?.title??"",groupedFields:b,data:O,onSubmit:F,onCancel:o,methods:r,components:l,widget:e?.widget,sqlOpsUrls:g,refid:S,module_refid:e?.module_refid}),simple:t.jsx(Me,{title:e?.title??"",fields:e.fields,data:O,onSubmit:F,onCancel:o,methods:r,components:l,sqlOpsUrls:g,refid:S,module_refid:e?.module_refid})};return t.jsx("div",{className:"relative",children:I[d]??I.simple})}W.LogiksForm=De,Object.defineProperty(W,Symbol.toStringTag,{value:"Module"})});
