(function(G,O){typeof exports=="object"&&typeof module<"u"?O(exports,require("react"),require("axios"),require("yup"),require("formik")):typeof define=="function"&&define.amd?define(["exports","react","axios","yup","formik"],O):(G=typeof globalThis<"u"?globalThis:G||self,O(G.LogiksForm={},G.React,G.axios,G.Yup,G.formik))})(this,function(G,O,D,ve,ne){"use strict";function je(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const i in e)if(i!=="default"){const n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:()=>e[i]})}}return r.default=e,Object.freeze(r)}const z=je(ve);var oe={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pe;function we(){if(pe)return J;pe=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(n,l,m){var g=null;if(m!==void 0&&(g=""+m),l.key!==void 0&&(g=""+l.key),"key"in l){m={};for(var u in l)u!=="key"&&(m[u]=l[u])}else m=l;return l=m.ref,{$$typeof:e,type:n,key:g,ref:l!==void 0?l:null,props:m}}return J.Fragment=r,J.jsx=i,J.jsxs=i,J}var ee={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be;function Ne(){return be||(be=1,process.env.NODE_ENV!=="production"&&function(){function e(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===q?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case j:return"Fragment";case $:return"Profiler";case N:return"StrictMode";case s:return"Suspense";case R:return"SuspenseList";case k:return"Activity"}if(typeof a=="object")switch(typeof a.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),a.$$typeof){case F:return"Portal";case P:return(a.displayName||"Context")+".Provider";case f:return(a._context.displayName||"Context")+".Consumer";case T:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case V:return o=a.displayName||null,o!==null?o:e(a.type)||"Memo";case S:o=a._payload,a=a._init;try{return e(a(o))}catch{}}return null}function r(a){return""+a}function i(a){try{r(a);var o=!1}catch{o=!0}if(o){o=console;var d=o.error,x=typeof Symbol=="function"&&Symbol.toStringTag&&a[Symbol.toStringTag]||a.constructor.name||"Object";return d.call(o,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",x),r(a)}}function n(a){if(a===j)return"<>";if(typeof a=="object"&&a!==null&&a.$$typeof===S)return"<...>";try{var o=e(a);return o?"<"+o+">":"<...>"}catch{return"<...>"}}function l(){var a=Y.A;return a===null?null:a.getOwner()}function m(){return Error("react-stack-top-frame")}function g(a){if(M.call(a,"key")){var o=Object.getOwnPropertyDescriptor(a,"key").get;if(o&&o.isReactWarning)return!1}return a.key!==void 0}function u(a,o){function d(){K||(K=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",o))}d.isReactWarning=!0,Object.defineProperty(a,"key",{get:d,configurable:!0})}function y(){var a=e(this.type);return E[a]||(E[a]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),a=this.props.ref,a!==void 0?a:null}function v(a,o,d,x,p,C,B,W){return d=C.ref,a={$$typeof:I,type:a,key:o,props:C,_owner:p},(d!==void 0?d:null)!==null?Object.defineProperty(a,"ref",{enumerable:!1,get:y}):Object.defineProperty(a,"ref",{enumerable:!1,value:null}),a._store={},Object.defineProperty(a._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(a,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(a,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:B}),Object.defineProperty(a,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:W}),Object.freeze&&(Object.freeze(a.props),Object.freeze(a)),a}function b(a,o,d,x,p,C,B,W){var L=o.children;if(L!==void 0)if(x)if(H(L)){for(x=0;x<L.length;x++)w(L[x]);Object.freeze&&Object.freeze(L)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else w(L);if(M.call(o,"key")){L=e(a);var Q=Object.keys(o).filter(function(De){return De!=="key"});x=0<Q.length?"{key: someKey, "+Q.join(": ..., ")+": ...}":"{key: someKey}",h[L+x]||(Q=0<Q.length?"{"+Q.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,x,L,Q,L),h[L+x]=!0)}if(L=null,d!==void 0&&(i(d),L=""+d),g(o)&&(i(o.key),L=""+o.key),"key"in o){d={};for(var se in o)se!=="key"&&(d[se]=o[se])}else d=o;return L&&u(d,typeof a=="function"?a.displayName||a.name||"Unknown":a),v(a,L,C,p,l(),d,B,W)}function w(a){typeof a=="object"&&a!==null&&a.$$typeof===I&&a._store&&(a._store.validated=1)}var A=O,I=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),P=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),s=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),q=Symbol.for("react.client.reference"),Y=A.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=Object.prototype.hasOwnProperty,H=Array.isArray,ae=console.createTask?console.createTask:function(){return null};A={"react-stack-bottom-frame":function(a){return a()}};var K,E={},_=A["react-stack-bottom-frame"].bind(A,m)(),c=ae(n(m)),h={};ee.Fragment=j,ee.jsx=function(a,o,d,x,p){var C=1e4>Y.recentlyCreatedOwnerStacks++;return b(a,o,d,!1,x,p,C?Error("react-stack-top-frame"):_,C?ae(n(a)):c)},ee.jsxs=function(a,o,d,x,p){var C=1e4>Y.recentlyCreatedOwnerStacks++;return b(a,o,d,!0,x,p,C?Error("react-stack-top-frame"):_,C?ae(n(a)):c)}}()),ee}var xe;function Se(){return xe||(xe=1,process.env.NODE_ENV==="production"?oe.exports=we():oe.exports=Ne()),oe.exports}var t=Se();function Ee(e){return e.template==="accordion"?"accordion":e.template==="simple"?"simple":e.template==="cards"?"cards":Object.values(e.fields||{}).some(n=>n.group)?"tab":"simple"}function Ae(e,r="create",i="Info"){const n={};let l=!1;if(Object.values(e).forEach(g=>{g.group&&(l=!0)}),!l)return{};const m=[];return Object.entries(e).forEach(([g,u])=>{if(u.vmode==="edit"&&r==="create")return;const y={...u,name:g};if(u.group){const v=u.group;n[v]||(n[v]=[]),n[v].push(y)}else m.push(y)}),m.length>0?{[i]:m,...n}:n}function ge(e,r="create"){const i={};return Object.keys(e).forEach(n=>{e[n].vmode==="edit"&&r==="create"||(i[n]={label:n,required:e[n].required??!1})}),i}const te=(e,r,i,n)=>{e.forEach(l=>{const m=l?.name;if(!m)return;let g=n?.[m];g==null&&(g=l.default),l.multiple===!0||l.type==="checkbox"||l.type==="tags"?r[m]=Array.isArray(g)?g:typeof g=="string"?g.split(",").map(y=>y.trim()).filter(Boolean):[]:l.type==="json"?r[m]=typeof g=="object"&&g!==null?JSON.stringify(g,null,2):g??"":l.type==="date"?r[m]=typeof g=="string"?g.slice(0,10):"":l.type==="time"?typeof g=="string"?g.includes("T")?r[m]=g.slice(11,16):r[m]=g.slice(0,5):r[m]="":m==="blocked"||m==="blacklist"?r[m]=String(g??"false"):r[m]=g??"";let u;l.type==="file"?u=l.multiple?z.array().of(z.mixed()):z.mixed():l.multiple===!0||l.type==="checkbox"||l.type==="tags"?u=z.array().of(z.string()):l.type==="email"?u=z.string().email("Invalid email"):l.type==="number"?u=z.number().typeError("Must be a number"):l.type==="json"?u=z.string().test("json","Invalid JSON",y=>{if(!y)return!0;try{return JSON.parse(y),!0}catch{return!1}}):u=z.string(),l.required&&(u=u.required(l.error_message||`${l.label||m} is required`)),l?.validate?.regex&&typeof l.validate.regex=="string"&&(u=u.matches(new RegExp(l?.validate?.regex),l?.error_message||"Invalid input format")),l?.validate&&Object.entries(l.validate).forEach(([y,v])=>{switch(y){case"email":v&&(u=u.email("Invalid email format"));break;case"mobile":u=u.matches(/^[1-9][0-9]*$/,"Invalid mobile number format");break;case"regex":u=u.matches(new RegExp(v),`Must match pattern: ${v}`);break;case"date":u=z.date().typeError("Invalid date format (expected dd/MM/yyyy or dd-MM-yyyy)").transform((b,w)=>{if(typeof w=="string"){const A=w.replace(/-/g,"/"),[I,F,j]=A.split("/");if(I&&F&&j)return new Date(`${j}-${F}-${I}`)}return b});break;case"time":u=u.matches(/^([0-1][0-9]|2[0-3])[:\-]([0-5][0-9])$/,"Invalid time format (HH:MM)");break;case"timesec":u=u.matches(/^([0-1][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/,"Invalid time format (HH:MM:SS)");break;case"number":case"numeric":u=z.number().typeError("Must be numeric");break;case"float":case"decimal":u=z.number().typeError("Must be a decimal").transform((b,w)=>{if(w==null||w==="")return;const A=Number(w);if(isNaN(A))return b;if(typeof b=="number"&&!isNaN(b)){const I=Number(b);return Number.isInteger(I)?Number(A.toFixed(I)):A}return A});break;case"alphanumeric":u=u.matches(/^[a-z0-9]+$/i,"Must be alphanumeric");break;case"alpha":u=u.matches(/^[a-zA-Z]+$/,"Must contain only letters");break;case"upper":u=u.transform(b=>b&&b.toUpperCase());break;case"lower":u=u.transform(b=>b&&b.toLowerCase());break;case"length-min":{const b=Number(v);isNaN(b)||(u=u.min(b,`Minimum length is ${b}`));break}case"length-max":{const b=Number(v);isNaN(b)||(u=u.max(b,`Maximum length is ${b}`));break}}}),i[m]=u})},le={12:"lg:col-span-12",11:"lg:col-span-11",10:"lg:col-span-10",9:"lg:col-span-9",8:"lg:col-span-8",7:"lg:col-span-7",6:"lg:col-span-6",5:"lg:col-span-5",4:"lg:col-span-4",3:"lg:col-span-3",2:"lg:col-span-2",1:"lg:col-span-1"};function ie(e){return[1,2,3,4,5,6,7,8,9,10,11,12].includes(e)?e:6}const ce=e=>e===!0||e==="true",U=(e,r)=>typeof e=="string"?e.replace(/#(\w+)#/g,(i,n)=>r[n]!==void 0?String(r[n]):i):Array.isArray(e)?e.map(i=>U(i,r)):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([i,n])=>[U(i,r),U(n,r)])):e,X=(e,r,i,n)=>{if(!Array.isArray(i)||i.length===0)return{};const l=n??(i[0]&&typeof i[0]=="object"&&"category"in i[0]?"category":void 0);if(!l){const g={};return i.forEach(u=>{const y=u[e],v=u[r];y!=null&&v!=null&&(g[String(y)]=String(v))}),g}const m={};return i.forEach(g=>{const u=g[l]??"Others",y=g[e],v=g[r];y==null||v==null||(m[u]||(m[u]={}),m[u][String(y)]=String(v))}),m},ye=(e,r)=>{if(!e||r==null)return;const i=String(r);if(typeof Object.values(e)[0]=="string")return e[i];for(const l of Object.values(e))if(i in l)return l[i]},Oe=e=>{if(!e)return[];if(Array.isArray(e))return e.map(n=>[String(n.value),String(n.title??n.label??n.value)]);const r=Object.values(e);return r.length?typeof r[0]=="string"?Object.entries(e).map(([n,l])=>[String(n),l]):Object.values(e).flatMap(n=>Object.entries(n).map(([l,m])=>[String(l),m])):[]},fe=e=>{if(!e||typeof e!="object")return!1;const r=Object.values(e)[0];return typeof r=="object"&&r!==null&&!Array.isArray(r)};async function $e(){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by this browser. You cannot access this portal.");try{const e=await new Promise((n,l)=>{navigator.geolocation.getCurrentPosition(n,l,{enableHighAccuracy:!1,timeout:3e4,maximumAge:12e4})}),{latitude:r,longitude:i}=e.coords;return`${r},${i}`}catch(e){if(!(e instanceof GeolocationPositionError))throw new Error("Failed to get your location.");switch(e.code){case e.PERMISSION_DENIED:throw new Error("Please allow location access in browser settings.");case e.POSITION_UNAVAILABLE:throw new Error("Unable to detect your location. Try connecting to Wi-Fi.");case e.TIMEOUT:throw new Error("Your device took too long to fetch GPS position.");default:throw new Error("Failed to get your location.")}}}const Te=e=>Object.entries(e??{}).filter(([,r])=>r.type==="geolocation").map(([r])=>r);function Ce(e,r="create"){return Object.entries(e).filter(([,i])=>!(i.vmode==="edit"&&r==="create")).map(([i,n])=>({...n,name:i}))}async function ue(e,r,i,n=void 0,l={}){try{let m=i;return m||(m=(await D({method:"POST",url:e.baseURL+e.registerQuery,data:{query:r??{}},headers:{Authorization:`Bearer ${e?.accessToken}`}})).data.queryid),await D({method:"POST",url:e.baseURL+e.runQuery,data:{queryid:m,filter:l,refid:n,page:0,limit:1e4},headers:{Authorization:`Bearer ${e?.accessToken}`}})}catch(m){throw m}}function Ie(e){return typeof e=="object"&&e!==null&&typeof e.target=="string"&&typeof e.src=="object"&&e.src!==null&&typeof e.src.table=="string"}function Fe(e){return e.split(",").map(r=>r.trim()).map(r=>{const i=r.match(/^(.+?)\s+as\s+.+$/i);return i?i[1]?.trim():r}).filter(r=>!!r)}const Z=e=>{const r={};for(const[i,n]of Object.entries(e)){const l=i.includes(".")?i.split(".").pop():i;if(l in r){console.warn(`Duplicate key after normalization: ${l}`);continue}r[l]=n}return r};function de({field:e,formik:r,methods:i={},sqlOpsUrls:n,refid:l,optionsOverride:m,setFieldOptions:g}){const[u,y]=O.useState(!1),[v,b]=O.useState(m??e.options??{}),[w,A]=O.useState(""),[I,F]=O.useState(0),j=O.useRef(null),N=O.useRef(null),[$,f]=O.useState(!1),P=O.useRef(w);O.useEffect(()=>{P.current=w},[w]);const T=E=>{E.currentTarget.open||A("")};O.useEffect(()=>{m&&Object.keys(m).length!==0&&b(m)},[m]),O.useEffect(()=>{const E=_=>{N.current&&!N.current.contains(_.target)&&(N.current.open=!1,A(""))};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const s=e.name;O.useEffect(()=>{let E=!0;return(async()=>{let c=e.valueKey??"value",h=e.labelKey??"title";if(e?.options){if(typeof e.options=="object"&&!Array.isArray(e.options)){const p=Object.values(e.options);if(p.length&&typeof p[0]=="string"){b(e.options);return}}const d=(Array.isArray(e.options)?e.options:[e.options]).map(Z),x=X(c,h,d,e.groupKey);b(x);return}const a=e?.source??{};if(e.type==="dataMethod"){const o=e.method,d=o?i[o]:void 0;if(d)try{const x=await Promise.resolve(d()),p=Array.isArray(x?.data?.data)?x.data.data:Array.isArray(x?.data)?x.data:x,C=Array.isArray(p)?p.map(Z):[],B=X(c,h,C,e.groupKey);E&&b(B)}catch(x){console.error("Method execution failed:",x),E&&b({})}else E&&b({})}if(a.type==="api"&&a.url)try{const o=await D({method:a.method||"GET",url:a.url,data:a.body??{},params:a.params??{},headers:a.headers??{}}),d=Array.isArray(o?.data?.data)?o.data.data:Array.isArray(o?.data)?o.data:o,x=Array.isArray(d)?d.map(Z):[],p=X(c,h,x,e.groupKey);E&&b(p)}catch(o){console.error("API execution failed:",o),E&&b({})}if(e.table||e.type==="dataSelector"||e.queryid){if(!n){console.error("SQL source requires formJson.endPoints but it is missing");return}try{let o;if(e.type==="dataSelector")o={table:"do_lists",cols:"title,value",where:{groupid:e.groupid??""}};else if(!e.queryid){if(!e.table||!e.columns){console.error("Invalid SQL field config",e);return}o={table:e.table,cols:e.columns,where:e.where?l?U(e.where,{refid:l}):e.where:void 0}}const d=await ue(n,o,e?.queryid),x=Array.isArray(d?.data?.data)?d.data.data:Array.isArray(d?.data)?d.data:d,p=Array.isArray(x)?x.map(Z):[],C=X(c,h,p,e.groupKey);E&&b(C)}catch(o){console.error("API fetch failed:",o)}}})(),()=>{E=!1}},[e.options,e.source,e.table,e.columns,e.where,l]);const R=`
    w-full px-4 py-2 rounded-lg border border-gray-200 transition-all duration-300 
    bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
    focus:outline-none focus:ring-0
  `,V=`
    border-gradient-to-r 
    focus:border-gray-400 focus:shadow-lg focus:shadow-gray-100/50
  `,S=`
    block text-sm font-semibold mb-1  transition-all duration-300 text-gray-700
  `,k=E=>E.icon?t.jsx("i",{className:E.icon}):null,q=O.useMemo(()=>Oe(v),[v]);console.log("flatOptions",q);const Y=q.length,M=O.useMemo(()=>e.search||!w?q:q.filter(([,E])=>E.toLowerCase().includes(w.toLowerCase())),[e.search,w,q]),H=(E,_)=>{if(N.current?.open===!0||$===!0)if(E.key==="ArrowDown")E.preventDefault(),F(c=>c+1<M.length?c+1:0);else if(E.key==="ArrowUp")E.preventDefault(),F(c=>c-1>=0?c-1:M.length-1);else if(E.key==="Enter"){E.preventDefault();const[c]=M[I]||[];c&&r.setFieldValue(e.name,_?c:[...r.values[e.name],c]),N.current&&(N.current.open=!1)}else E.key==="Escape"&&(N.current.open=!1,A(""),f(!1))};O.useEffect(()=>{j.current?.querySelector(`[data-index="${I}"]`)?.scrollIntoView({block:"nearest"})},[I]),O.useEffect(()=>{I>=M.length&&F(0)},[M,I]),O.useEffect(()=>{const E=e.autocomplete,_=e.ajaxchain;if(!E&&!_)return;const c=r.values[e.name];if(!c)return;const h=Array.isArray(_)?_:_?[_]:[];(async()=>{try{if(Ie(E)){const o=E.src;if(!o||!n)return;const d=U(o.where??{},{refid:c}),x={...o,table:o.table,cols:o.columns,where:d},{data:p}=await ue(n,x,e?.queryid),C=Array.isArray(p?.data)?p.data[0]:p?.data;C&&E.target.split(",").map(B=>B.trim()).forEach(B=>{C[B]!==void 0&&r.setFieldValue(B,C[B])})}for(const o of h){const d=o.src;if(!o||typeof o!="object"||!d||typeof d!="object"||!n)continue;let x;if(!d.queryid){if(!d.table||!d.columns)throw new Error("SQL query requires field.table");const se=U(d?.where??{},{refid:c});x={...d,table:d.table,cols:d.columns,where:se}}const{data:p}=await ue(n,x,d?.queryid,c);let C=e.valueKey??"value",B=e.labelKey??"title";const W=Array.isArray(p?.data?.data)?p.data.data:Array.isArray(p?.data)?p.data:p,L=Array.isArray(W)?W.map(Z):[],Q=X(C,B,L,e.groupKey);g?.(o.target,Q)}}catch(o){console.error("Autocomplete / AjaxChain fetch failed",o)}})()},[r.values[e.name]]),O.useEffect(()=>{if(!e.search||!w.trim()||!e.table||!n)return;const E=Fe(e.columns??""),_=new AbortController,c=setTimeout(async()=>{try{let h;if(!e.queryid){if(!e.table||!e.cols)throw new Error("SQL query requires field.table");const W=l?U(e.where??{},{refid:l}):e.where;h={...e,table:e.table,cols:e.columns||e.cols,where:W}}let a={};Array.isArray(E)&&E.forEach(W=>{a[W]=[w,"LIKE"]});let o=e.valueKey??"value",d=e.labelKey??"title";const{data:x}=await ue(n,h,e?.queryid,void 0,a),p=Array.isArray(x?.data?.data)?x.data.data:Array.isArray(x?.data)?x.data:x,C=Array.isArray(p)?p.map(Z):[],B=X(o,d,C,e.groupKey);b(B)}catch(h){if(D.isCancel(h))return;console.error("Search fetch failed",h)}},500);return()=>{clearTimeout(c),_.abort()}},[w,l]);const ae=async E=>{if(E.length===0){console.error("No file");return}const _=n?.baseURL+n?.uploadURL;if(!_){console.error("No Upload URL ");return}const c=e.multiple===!0;try{const h=await Promise.all(Array.from(E).map(async a=>{const o=new FormData;return o.append("file",a),(await D({method:"POST",url:_,data:o,headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${n?.accessToken}`}})).data}));r.setFieldValue(s,c?h.map(a=>a.path):h[0]?.path)}catch(h){console.error("File upload failed",h),r.setFieldError(s,"File upload failed")}};console.log("options",v);const K=async()=>{if(e.method){const E=e.method,_=E?i[E]:void 0;if(_)try{await Promise.resolve(_())}catch(c){console.error("Method execution failed:",c)}else console.error("No Method available:")}};switch(e.type){case"autocomplete":{const c=r.values[s]??"",h=w!==""?w:ye(v,c)??String(c??""),a=d=>{const x=d.target.value;A(x),F(0),x.trim()?f(!0):(f(!1),r.setFieldValue(s,""))},o=d=>{r.setFieldValue(s,d),A(""),f(!1)};return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{className:`${R} ${V}`,value:h,placeholder:e.placeholder||"Type to search...",onChange:a,onBlur:()=>{setTimeout(()=>f(!1),150)},onKeyDown:d=>{if(d.key==="Enter"){if(d.preventDefault(),M[I]){const[x]=M[I];r.setFieldValue(s,x)}else w.trim()&&r.setFieldValue(s,w.trim());f(!1);return}H(d,!0)},disabled:e.disabled}),$&&t.jsx("div",{ref:j,className:"absolute z-20 w-full bg-white border rounded shadow max-h-52 overflow-y-auto mt-1",children:M.length>0?M.map(([d,x],p)=>t.jsx("div",{id:`${s}-${d}`,"data-index":p,className:`px-3 py-2 cursor-pointer text-sm
                  ${I===p?"bg-gray-100":"hover:bg-gray-100"}`,onMouseDown:()=>o(d),children:x},d)):t.jsx("div",{className:"px-3 py-2 text-sm text-gray-400",children:`No matches press enter to add "${h}" `})}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}case"dataSelector":case"dataSelectorFromTable":case"dataSelectorFromUniques":case"dataMethod":{if(e.multiple===!0){const c=r.values[s];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("details",{className:"relative w-full",onToggle:T,ref:N,onKeyDown:h=>H(h,!1),onClick:K,children:[t.jsxs("summary",{className:"cursor-pointer select-none border border-gray-300 rounded-lg px-3 py-2 bg-white flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-700",children:c?.length>0?c.join(", "):`Select ${e.label}`}),t.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs("div",{ref:j,className:"absolute mt-1 w-full border border-gray-200 rounded-lg bg-white shadow-md z-10 max-h-60 overflow-y-auto p-2",children:[e.search&&t.jsx("div",{className:"sticky top-0 bg-white p-1",children:t.jsx("input",{type:"text",value:w,onChange:h=>{A(h.target.value),F(0)},placeholder:"Search...",className:`px-2 py-[5px] rounded w-full border border-gray-200 transition-all duration-300 
                bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
                focus:outline-none focus:ring-0`})}),M.length>0?M.map(([h,a],o)=>t.jsxs("label",{htmlFor:`${s}-${h}`,className:`flex items-center gap-x-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm
                        ${c?.includes(h)?"bg-indigo-50 text-indigo-600 font-medium":I===o?"bg-gray-100":"hover:bg-gray-50"}`,children:[t.jsx("input",{id:`${s}-${h}`,type:"checkbox",checked:c?.includes(h),onChange:d=>{const x=d.target.checked?[...c,h]:c?.filter(p=>p!==h);r.setFieldValue(s,x)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),a]},h)):t.jsx("div",{className:"px-2 py-1 text-gray-400 text-sm",children:"No results"})]})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("details",{className:"relative w-full",onToggle:T,ref:N,onKeyDown:c=>H(c,!0),onClick:K,children:[t.jsxs("summary",{className:"cursor-pointer select-none border border-gray-300 rounded-lg px-3 py-2 bg-white flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-700",children:r.values[s]?ye(v,r.values[s])??"Select option":`Select ${e.label}`}),t.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs("div",{ref:j,className:"absolute mt-1 w-full border border-gray-200 rounded-lg bg-white shadow-md z-10 max-h-60 overflow-y-auto p-2",children:[e.search&&t.jsx("div",{className:"sticky top-0 bg-white p-1",children:t.jsx("input",{type:"text",value:w,onChange:c=>{A(c.target.value),F(0)},onKeyDown:c=>H(c,!0),placeholder:"Search...",className:`px-2 py-[5px] rounded w-full border border-gray-200 transition-all duration-300 
                  bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400
                  focus:outline-none focus:ring-0`})}),M.length>0&&t.jsx("div",{onClick:c=>{c.preventDefault(),c.stopPropagation(),r.setFieldValue(s,""),N.current?.removeAttribute("open"),A("")},className:"px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm hover:bg-gray-50",children:"Clear selection"}),M.length>0?M.map(([c,h],a)=>(console.log("label",h),t.jsx("div",{id:`${s}-${c}`,"data-index":a,onClick:o=>{o.preventDefault(),o.stopPropagation(),r.setFieldValue(s,c),N.current?.removeAttribute("open"),A(""),F(0)},className:`px-2 py-1 hover:bg-gray-50 rounded cursor-pointer text-sm 
                        ${r.values[s]===c?"bg-indigo-50 text-indigo-600 font-medium":I===a?"bg-gray-100":"hover:bg-gray-50"}`,children:h},c))):t.jsx("div",{className:"px-2 py-1 text-gray-400 text-sm",children:"No results"})]})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}case"textarea":return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("textarea",{id:s,onClick:K,className:`${R} ${V} min-h-[120px] resize-none`,onFocus:()=>y(!0),name:s,value:r.values[s],onBlur:r.handleBlur,onChange:r.handleChange,placeholder:e.placeholder,disabled:e.disabled}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${u?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})});case"select":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("select",{className:`${R} ${V} appearance-none cursor-pointer pr-12`,onFocus:()=>y(!0),onClick:K,name:s,id:s,value:r.values[s],onBlur:r.handleBlur,onChange:r.handleChange,disabled:e.disabled,children:[t.jsx("option",{value:"",disabled:!0,children:e?.["no-option"]||`Please select ${e.label}`}),!fe(v)&&Object.entries(v).map(([c,h])=>t.jsx("option",{value:c,className:"py-2",children:h},c)),fe(v)&&Object.entries(v).map(([c,h])=>t.jsx("optgroup",{label:c,children:Object.entries(h).map(([a,o])=>t.jsx("option",{value:a,children:o},a))},c))]}),t.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:t.jsx("svg",{className:"w-5 h-5 transition-colors duration-300 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"radioList":case"radio":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{onClick:K,className:`flex ${Y>3?"flex-col":""} gap-2 ml-1`,children:Object.entries(v||{}).map(([c,h])=>t.jsxs("label",{htmlFor:`${s}-${c}`,className:"flex items-center gap-x-2 text-sm font-medium text-gray-700 cursor-pointer",children:[t.jsx("input",{id:`${s}-${c}`,type:"radio",name:s,checked:r.values[s]===c,value:c,onChange:r.handleChange,onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),h]},c))}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]});case"checkbox":{const c=r.values[s];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{onClick:K,className:"flex flex-col gap-2 ml-1",children:Object.entries(v||{}).map(([h,a])=>t.jsxs("label",{className:"flex items-center gap-x-2 text-sm font-medium text-gray-700 cursor-pointer",children:[t.jsx("input",{id:`${s}-${h}`,type:"checkbox",checked:c.includes(h),onChange:o=>{const d=o.target.checked?[...c,h]:c.filter(x=>x!==h);r.setFieldValue(s,d)},onBlur:r.handleBlur,disabled:e.disabled,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),a]},h))}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500 ml-2",children:String(r.errors[s])})]})}case"tags":{const c=r.values[s],h=w.trim(),a=Array.isArray(v)?v:Object.entries(v||{}).map(([p,C])=>({value:p,label:C})),o=p=>{p&&!c.includes(p)&&(r.setFieldValue(s,[...c,p]),A(""))},d=p=>{r.setFieldValue(s,c.filter(C=>C!==p))},x=p=>a.find(C=>C.value===p)?.label??p;return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:`${R} flex flex-wrap gap-2 min-h-[42px] max-h-[120px] overflow-y-auto items-center`,onClick:()=>!e.disabled&&document.getElementById(`${s}-input`)?.focus(),children:[c.map(p=>t.jsxs("span",{className:"flex items-center gap-2 px-2 py-1 rounded-full text-sm bg-indigo-50 border border-indigo-100",children:[t.jsx("span",{className:"text-indigo-700",children:x(p)}),t.jsx("button",{type:"button",onClick:C=>{C.stopPropagation(),e.disabled||d(p)},onMouseDown:C=>C.preventDefault(),className:"ml-1 text-indigo-500 hover:text-red-500 focus:outline-none",children:"Ã—"})]},p)),t.jsx("input",{id:`${s}-input`,type:"text",value:w,onChange:p=>A(p.target.value),onKeyDown:p=>{(p.key==="Enter"||p.key===",")&&(p.preventDefault(),o(h))},placeholder:c.length===0?e.placeholder||"Type and press Enter":"",className:"flex-1 min-w-[120px] border-none outline-none text-sm bg-transparent p-1",disabled:e.disabled})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}case"attachment":case"photo":case"avatar":case"file":const E=e.multiple===!0,_=Array.isArray(r.values[s])?r.values[s]:r.values[s]?[r.values[s]]:[];return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:k(e)}),t.jsx("input",{onClick:K,id:s,type:"file",className:`${R} ${V} ${e.icon?"pl-9":""} `,onFocus:()=>y(!0),name:s,multiple:E,onChange:c=>{const h=c.currentTarget.files;h&&ae(h)},onBlur:r.handleBlur,placeholder:e.placeholder,disabled:e.disabled}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${u?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),_.map(c=>{const h=c?.split("/").pop();return h?t.jsx("div",{className:"mt-1",children:t.jsx("span",{className:"text-sm",children:h})},c):null}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"json":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{onClick:K,className:"relative",children:[t.jsx("textarea",{id:s,name:s,value:r.values[s],onChange:c=>r.setFieldValue(s,c.target.value),onBlur:r.handleBlur,placeholder:e.placeholder||"Enter valid JSON",disabled:e.disabled,className:`${R} ${V} min-h-[200px] font-mono text-sm resize-y`}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-emerald-400 to-cyan-400 opacity-0 transition-opacity duration-300 pointer-events-none ${u?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});case"date":return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{onClick:K,className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:k(e)}),t.jsx("input",{id:s,type:"date",name:s,value:r.values[s],onChange:r.handleChange,onBlur:r.handleBlur,placeholder:e.placeholder,disabled:e.disabled,className:`${R} ${V} ${e.icon?"pl-9":""}`}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${u?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]});default:return t.jsxs("div",{className:"relative",children:[t.jsxs("label",{className:S,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[e.icon&&t.jsx("div",{className:"absolute z-10 left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:k(e)}),t.jsx("input",{onClick:K,id:s,type:e.type||"text",className:`${R} ${V} ${e.icon?"pl-9":""} `,onFocus:()=>y(!0),name:s,value:r.values[s],onBlur:r.handleBlur,onChange:r.handleChange,placeholder:e.placeholder,disabled:e.disabled}),t.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 transition-opacity duration-300 pointer-events-none ${u?"opacity-20":""}`,style:{zIndex:-1,filter:"blur(8px)"}})]}),r.touched[s]&&r.errors[s]&&t.jsx("span",{className:"text-xs text-red-500",children:String(r.errors[s])})]})}}function Pe({title:e,children:r,isFirst:i}){const[n,l]=O.useState(i);return t.jsx("div",{className:"group relative mt-1",children:t.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-100 shadow-xs hover:shadow-sm transition-all duration-300 overflow-hidden ",children:[t.jsxs("button",{onClick:()=>l(!n),className:"w-full bg-gray-50 flex justify-between items-center px-6 py-3 b text-left transition-all duration-300 ",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full transition-all duration-300 ${n?"bg-action":"bg-gray-300"}`}),t.jsx("h3",{className:"text-md font-semibold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:e})]}),t.jsxs("div",{className:`relative transition-all duration-300 ${n?"rotate-180":""}`,children:[t.jsx("div",{className:`absolute inset-0 rounded-full blur-md transition-opacity duration-300 ${n?"bg-action opacity-30":"bg-transparent opacity-0"}`}),t.jsx("svg",{className:"relative w-4 h-4 text-gray-500 group-hover:text-action-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),t.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden  ${n?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:t.jsx("div",{className:"px-6 pb-6 bg-gradient-to-br from-gray-50/50 to-white overflow-auto mb-5",children:t.jsx("div",{className:"space-y-5 pt-4",children:r})})})]})})}function ke({title:e,groupedFields:r,data:i,onSubmit:n=v=>{},onCancel:l=()=>{},methods:m={},components:g={},sqlOpsUrls:u={},refid:y}){const[v,b]=O.useState({}),w=(j,N)=>{b($=>({...$,[j]:N}))},{initialValues:A,validationSchema:I}=O.useMemo(()=>{const j={},N={};return Object.values(r).flat().forEach($=>{te([$],j,N,i)}),{initialValues:j,validationSchema:N}},[r,i]),F=ne.useFormik({initialValues:A,enableReinitialize:!0,validationSchema:z.object().shape(I),onSubmit:j=>{n(j)}});return t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white border border-gray-100 rounded-md animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:F.handleSubmit,className:"p-4 mx-auto",children:[t.jsx("div",{className:"space-y-2",children:r&&Object.entries(r).map(([j,N],$)=>t.jsx(Pe,{title:j,isFirst:$===0,children:t.jsx("div",{className:"grid grid-cols-12 gap-4",children:N.map((f,P)=>ce(f.hidden)||f.type==="geolocation"||f.vmode==="edit"&&u.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${le[ie(Number(f.width))]||"lg:col-span-4"}`,children:t.jsx(de,{refid:y,sqlOpsUrls:u,components:g,field:f,formik:F,methods:m,setFieldOptions:w,...v[f.name]?{optionsOverride:v[f.name]}:{}},f.name)},f?.name??`field-${P}`))})},j))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"text-sm text-gray-700",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Save"})]})]})]})})})}function _e({title:e,groupedFields:r,data:i,onSubmit:n=b=>{},onCancel:l=()=>{},methods:m={},components:g={},sqlOpsUrls:u={},widget:y,refid:v}){const b=Object.keys(r),[w,A]=O.useState(0),[I,F]=O.useState({}),j=(S,k)=>{F(q=>({...q,[S]:k}))},{initialValues:N,validationSchema:$,stepperSchemas:f}=O.useMemo(()=>{const S={},k={},q={};return y?Object.entries(r).forEach(([Y,M])=>{const H={};te(M,S,H,i),q[Y]=H}):Object.entries(r).forEach(([Y,M])=>{te(M,S,k,i)}),{initialValues:S,validationSchema:k,stepperSchemas:q}},[r,i,y]),P=b[w]??null,T=y&&P?f[P]??{}:$,s=ne.useFormik({initialValues:N,enableReinitialize:!0,validationSchema:z.object().shape(T),onSubmit:S=>{y?(w<b.length-1&&A(k=>k+1),w===b.length-1&&n(S)):n(S)}}),R=async S=>{if(S.preventDefault(),!y){const k=await s.validateForm();if(Object.keys(k).length>0){alert("Please fill all required fields before submitting."),s.setTouched(Object.keys(k).reduce((q,Y)=>({...q,[Y]:!0}),{}));return}}s.handleSubmit(S)},V=()=>{A(S=>S>0?S-1:S)};return t.jsxs("div",{className:" max-w-full  m-4",children:[t.jsx("div",{className:"relative",children:t.jsx("div",{className:"relative bg-gray-100 rounded-t-lg px-1 pt-1  shadow-inner",children:t.jsx("nav",{className:"relative flex",children:b.map((S,k)=>t.jsx("button",{type:"button",onClick:()=>A(k),className:`relative cursor-pointer flex-shrink-0 py-2 px-2 sm:px-4 rounded-t-lg  text-xs sm:text-sm font-semibold transition-all duration-300 ease-out focus:outline-none whitespace-nowrap ${w===k?"text-action bg-white":"text-gray-600 hover:text-gray-800 hover:bg-white/50"}`,children:t.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2 capitalize",children:S})},S))})})}),t.jsxs("div",{className:"bg-white  border border-gray-100 border-t-0 rounded-b-lg p-3 animate-in fade-in duration-300",children:[t.jsxs("form",{onSubmit:R,className:"w-full mx-auto",children:[t.jsx("div",{className:"grid grid-cols-12 gap-4",children:P&&r[P]?.map((S,k)=>ce(S.hidden)||S.type==="geolocation"||S.vmode==="edit"&&u.operation==="create"?null:t.jsx("div",{className:`col-span-12  ${le[ie(Number(S.width))]||"lg:col-span-4"}`,children:t.jsx(de,{refid:v,sqlOpsUrls:u,field:S,formik:s,methods:m,components:g,setFieldOptions:j,...I[S.name]?{optionsOverride:I[S.name]}:{}},S.name)},S?.name??`field-${k}`))}),t.jsxs("div",{className:`mt-8 flex ${w>0?"justify-between":"justify-end"} space-x-3`,children:[w>0&&t.jsx("button",{onClick:V,type:"button",className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Previous"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{onClick:l,type:"button",className:"px-5 cursor-pointer py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 cursor-pointer py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:y?"Next":"Save"})]})]})]}),t.jsx("div",{className:"mt-2 pt-3  border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{children:["Tab ",w+1," of ",b.length]}),t.jsx("p",{className:"text-sm text-gray-700 ml-3",children:"All fields marked (*) are required"})]}),t.jsx("div",{className:"flex gap-1",children:b.map((S,k)=>t.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${k===w?"bg-action w-6":"bg-gray-300"}`},k))})]})})]},b[w])]})}function Re({title:e,fields:r,data:i,onSubmit:n=y=>{},onCancel:l=()=>{},methods:m={},sqlOpsUrls:g={},refid:u}){const y=Ce(r,g.operation),[v,b]=O.useState({}),w=(j,N)=>{b($=>({...$,[j]:N}))},{initialValues:A,validationSchema:I}=O.useMemo(()=>{const j={},N={};return y.forEach($=>{te([$],j,N,i)}),{initialValues:j,validationSchema:N}},[y,i]),F=ne.useFormik({initialValues:A,enableReinitialize:!0,validationSchema:z.object().shape(I),onSubmit:j=>{n(j)}});return console.log("formik.values",F.values),t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white border border-gray-100 rounded-md animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:F.handleSubmit,className:"p-4  mx-auto",children:[t.jsx("div",{className:"grid grid-cols-12 gap-4",children:y.map((j,N)=>ce(j.hidden)||j.type==="geolocation"||j.vmode==="edit"&&g.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${le[ie(Number(j.width))]||"lg:col-span-4"}`,children:t.jsx(de,{refid:u,sqlOpsUrls:g,field:j,formik:F,methods:m,setFieldOptions:w,...v[j.name]?{optionsOverride:v[j.name]}:{}})},j?.name??`field-${N}`))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"text-sm text-gray-700",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 cursor-pointer",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 cursor-pointer",children:"Save"})]})]})]})})})}function Me({title:e,children:r}){return t.jsx("div",{className:"group relative mt-1",children:t.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden ",children:[t.jsx("button",{className:"w-full bg-gray-50 flex justify-between items-center px-6 py-3 b text-left transition-all duration-300 ",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 rounded-full transition-all duration-300 bg-action"}),t.jsx("h3",{className:"text-md font-semibold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:e})]})}),t.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden max-h-[2000px] opacity-100'
            }`,children:t.jsx("div",{className:"px-6 pb-6 bg-gradient-to-br from-gray-50/50 to-white",children:t.jsx("div",{className:"space-y-5 pt-4",children:r})})})]})})}function Le({title:e,groupedFields:r,data:i,onSubmit:n=v=>{},onCancel:l=()=>{},methods:m={},components:g={},sqlOpsUrls:u={},refid:y}){const[v,b]=O.useState({}),w=(j,N)=>{b($=>({...$,[j]:N}))},{initialValues:A,validationSchema:I}=O.useMemo(()=>{const j={},N={};return Object.values(r).flat().forEach($=>{te([$],j,N,i)}),{initialValues:j,validationSchema:N}},[r,i]),F=ne.useFormik({initialValues:A,enableReinitialize:!0,validationSchema:z.object().shape(I),onSubmit:j=>{n(j)}});return t.jsx("div",{className:"relative z-10 max-w-full  m-4",children:t.jsx("div",{className:"bg-white animate-in fade-in duration-300",children:t.jsxs("form",{onSubmit:F.handleSubmit,className:"p-4 mx-auto",children:[t.jsx("div",{className:"space-y-2",children:r&&Object.entries(r).map(([j,N],$)=>t.jsx(Me,{title:j,children:t.jsx("div",{className:"grid grid-cols-12 gap-4",children:N.map((f,P)=>ce(f.hidden)||f.type==="geolocation"||f.vmode==="edit"&&u.operation==="create"?null:t.jsx("div",{className:`col-span-12 md:col-span-6 ${le[ie(Number(f.width))]||"lg:col-span-4"}`,children:t.jsx(de,{refid:y,sqlOpsUrls:u,components:g,field:f,formik:F,methods:m,setFieldOptions:w,...v[f.name]?{optionsOverride:v[f.name]}:{}},f.name)},f?.name??`field-${P}`))})},j))}),t.jsxs("div",{className:"mt-8 flex justify-between space-x-3",children:[t.jsx("p",{className:"px-4 pt-4 text-sm text-secondary",children:"All fields marked (*) are required"}),t.jsxs("div",{className:"space-x-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-5 py-2 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-200  shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-5 py-2 bg-action font-semibold rounded-lg border-2 border-gray-200 shadow-sm hover:shadow-lg transform hover:scale-105 transition-all duration-300 ",children:"Save"})]})]})]})})})}const re=e=>({Authorization:`Bearer ${e.accessToken}`}),me=async e=>(await D.get(e.baseURL+e.dbopsGetHash,{headers:re(e)})).data.refhash,he=async(e,r)=>(await D.post(e.baseURL+e.dbopsGetRefId,r,{headers:re(e)})).data.refid,ze={async fetch(e,r,i){const n=await me(e);let l=!1,m;i&&(l=!0,m=i),console.log("skipquery,dbopsid",l,i),l||(m=await he(e,{operation:"fetch",source:r.source,fields:r.fields??{},datahash:n})),console.log("dbopsId",m);const g=await D.post(e.baseURL+e.dbopsFetch,{refid:m,datahash:n},{headers:re(e)});return g.data?.data??g.data},async create(e,r){const i=await me(e),n=await he(e,{operation:"create",source:r.source,fields:r.values,datahash:i});return(await D.post(e.baseURL+e.dbopsCreate,{refid:n,fields:r.values,datahash:i},{headers:re(e)})).data},async update(e,r){const i=await me(e),n=await he(e,{operation:"update",source:r.source,fields:r.values,datahash:i});return(await D.post(e.baseURL+e.dbopsUpdate,{refid:n,fields:r.values,datahash:i},{headers:re(e)})).data}};function qe({formJson:e={title:"",fields:{},source:{}},methods:r={},userid:i=null,onCancel:n=()=>{},components:l={},callback:m=()=>{},initialvalues:g={}}){let u=Ee(e);const y=e.endPoints,v=e?.source?.refid,b=Ae(e?.fields??{},y?.operation),[w,A]=O.useState(g),I=O.useMemo(()=>Te(e.fields),[e.fields]);O.useEffect(()=>{let N=!0;return(async()=>{const f=e?.source??{};if(!f?.type){N&&A({});return}if(f.type==="method"){const P=f.method,T=P?r[P]:void 0;if(T)try{const s=await Promise.resolve(T());N&&A(s??{})}catch(s){console.error("Method execution failed:",s),N&&A({})}else N&&A({})}if(f.type==="api"&&y?.operation!=="create")try{const P=await D({method:f.method||"GET",url:f.url??"",data:f.body??{},params:f.params??{},headers:f.headers??{}});N&&A(P.data??{})}catch(P){console.error("API fetch failed:",P),N&&A({})}if(f.type==="sql"&&f.refid&&f.refid!=="0"&&y?.operation!=="create"||y?.operation!=="create"&&f.dbopsid){if(!y){console.error("SQL source requires formJson.endPoints but it is missing");return}try{const P=await ze.fetch(y,{source:{...f,table:f.table,columns:f.columns,where:U(f.where,{refid:v})},fields:ge(e.fields,y.operation)},f?.dbopsid);N&&A(P)}catch(P){console.error("API fetch failed:",P)}}})(),()=>{N=!1}},[i,e?.source?.type||"",e?.source?.method||"",e?.source?.url||"",JSON.stringify(e?.source?.params??{}),JSON.stringify(e?.source?.body??{}),JSON.stringify(e?.source?.headers??{})]);const F=async N=>{const $=e?.source??{};let f=null;if(I.length>0)try{f=await $e()}catch(T){console.log("catch fetchGeolocation",T),f=null}const P={...N,...Object.fromEntries(I.map(T=>[T,f]))};if($.type==="method"){const T=$.method,s=T?r[T]:void 0;if(s)try{const R=await Promise.resolve(s(P));m?.(R)}catch(R){m?.(R),console.error("Method execution failed:",R)}}if($.type==="api"){if(!y){console.error("SQL source requires formJson.endPoints but it is missing");return}try{const T=await D({method:$.method||"POST",url:y.baseURL+$.endpoint,data:P??{},headers:{Authorization:`Bearer ${y?.accessToken}`}});m?.(T)}catch(T){m?.(T),console.error("API fetch failed:",T)}}if($.type==="sql"){const T=e.endPoints;if(!T){console.error("SQL source requires formJson.endPoints but it is missing");return}try{let s=!1,R;$?.dbopsid&&(s=!0,R=$?.dbopsid);const V=await D({method:"GET",url:T.baseURL+T.dbopsGetHash,headers:{Authorization:`Bearer ${T?.accessToken}`}});if(!s){let k={...$};$.where&&(k={...$,where:U($.where,{refid:v})}),R=(await D({method:"POST",url:T.baseURL+T.dbopsGetRefId,data:{operation:T.operation,source:k,fields:ge(e.fields,T.operation),forcefill:e.forcefill,datahash:V.data.refhash},headers:{Authorization:`Bearer ${T?.accessToken}`}}))?.data.refid}const S=await D({method:"POST",url:T.baseURL+T[T.operation==="update"?"dbopsUpdate":"dbopsCreate"],data:{refid:R,fields:P,datahash:V.data.refhash},headers:{Authorization:`Bearer ${T?.accessToken}`}});m?.(S)}catch(s){m?.(s),console.error("API fetch failed:",s)}}},j={accordion:t.jsx(ke,{title:e?.title??"",groupedFields:b,data:w,onSubmit:F,onCancel:n,methods:r,components:l,sqlOpsUrls:y,refid:v}),cards:t.jsx(Le,{title:e?.title??"",groupedFields:b,data:w,onSubmit:F,onCancel:n,methods:r,components:l,sqlOpsUrls:y,refid:v}),tab:t.jsx(_e,{title:e?.title??"",groupedFields:b,data:w,onSubmit:F,onCancel:n,methods:r,components:l,widget:e?.widget,sqlOpsUrls:y,refid:v}),simple:t.jsx(Re,{title:e?.title??"",fields:e.fields,data:w,onSubmit:F,onCancel:n,methods:r,components:l,sqlOpsUrls:y,refid:v})};return t.jsx("div",{className:"relative",children:j[u]??j.simple})}G.LogiksForm=qe,Object.defineProperty(G,Symbol.toStringTag,{value:"Module"})});
